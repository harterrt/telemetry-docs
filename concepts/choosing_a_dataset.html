
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Choosing a Dataset Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../datasets/" />
    
    
    <link rel="prev" href="analysis_intro.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="learning_paths.html">
            
                <a href="learning_paths.html">
            
                    
                    Intro to Analysis
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="analysis_intro.html">
            
                <a href="analysis_intro.html">
            
                    
                    Analysis Quick Start
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2.2" data-path="choosing_a_dataset.html">
            
                <a href="choosing_a_dataset.html">
            
                    
                    Choosing a Dataset
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../datasets/">
            
                <a href="../datasets/">
            
                    
                    Data Collection and Datasets
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" >
            
                <span>
            
                    
                    Understanding our Data
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" >
            
                <span>
            
                    
                    How we collect data (pings, studies, experiments)
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" >
            
                <span>
            
                    
                    Choosing a dataset
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.3" >
            
                <span>
            
                    
                    Experimental vs Descriptive Data
            
                </span>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" >
            
                <span>
            
                    
                    Dataset Reference
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" >
            
                <span>
            
                    
                    Pings
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" >
            
                <span>
            
                    
                    Derived Datasets
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.2.1" >
            
                <span>
            
                    
                    Longitudinal
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.2" >
            
                <span>
            
                    
                    Cross Sectional
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.3" >
            
                <span>
            
                    
                    Main Summary
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.4" >
            
                <span>
            
                    
                    Crash Summary
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.5" >
            
                <span>
            
                    
                    ETC
            
                </span>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2.3" >
            
                <span>
            
                    
                    Experimental Datasets
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.3.1" >
            
                <span>
            
                    
                    Accessing Shield Study data
            
                </span>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../tools/">
            
                <a href="../tools/">
            
                    
                    Tools
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" >
            
                <span>
            
                    
                    Interfaces
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" >
            
                <span>
            
                    
                    TMO & STMO
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.2" >
            
                <span>
            
                    
                    Distribution Viewer
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.3" >
            
                <span>
            
                    
                    Advanced analysis with ATMO
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.4" >
            
                <span>
            
                    
                    An Introduction to Spark
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.5" >
            
                <span>
            
                    
                    Realtime Analysis with CEP
            
                </span>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" >
            
                <span>
            
                    
                    Infrastructure
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" >
            
                <span>
            
                    
                    The Path to Re:dash
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1.1" >
            
                <span>
            
                    
                    Heka Messages
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.1.2" >
            
                <span>
            
                    
                    telemetry-batch-view
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.1.3" >
            
                <span>
            
                    
                    parquet2hive
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.1.4" >
            
                <span>
            
                    
                    Airflow
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.1.5" >
            
                <span>
            
                    
                    Presto
            
                </span>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../cookbooks/">
            
                <a href="../cookbooks/">
            
                    
                    Cookbooks
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../meta/README.md">
            
                <span>
            
                    
                    About this Documentation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="../meta/structure.html">
            
                <a href="../meta/structure.html">
            
                    
                    Structure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="../meta/contributing.html">
            
                <a href="../meta/contributing.html">
            
                    
                    Contributing
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Choosing a Dataset</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="choosing-a-dataset">Choosing a dataset</h1>
<p>This document is a quick overview of the datasets provided by the data pipeline
team.  After reading this document, you should have a good idea of what dataset
is the most useful for your analysis.</p>
<p>Before making final decisions from your findings, consider getting your query
or analysis reviewed by a member of the data pipeline team.</p>
<h2 id="accessing-a-dataset">Accessing a dataset</h2>
<p>Playing with the data is the best way to get comfortable.  All of these
datasets can be queried from <a href="http://sql.telemetry.mozilla.org" target="_blank">STMO</a> (AKA:
re:dash).  STMO will give you an interactive SQL interface, which should be
sufficient for getting comfortable with the data.  If you need to complete more
complicated analyses or want to productionize your code, see <a href="analyzing_telemetry_data.md">Analyzing
Telemetry Data</a>.</p>
<h2 id="overview">Overview</h2>
<p>Unless noted otherwise, these datasets summarize the <a href="https://gecko.readthedocs.io/en/latest/toolkit/components/telemetry/telemetry/data/main-ping.html" target="_blank">&quot;main&quot; Telemetry ping
type</a>.
The main ping payload contains most of the measurements used to track
performance and health of Firefox in the wild.  It can be useful to refer back
to the source ping documentation to understand how the source data was
generated.</p>
<h1 id="datasets">Datasets</h1>
<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><a href="#main-summary">main_summary</a></li>
<li><a href="#longitudinal">longitudinal</a></li>
<li><a href="#cross-sectional">cross_sectional</a></li>
<li><a href="#client-count">client_count</a></li>
<li><a href="#crash-aggregates">crash_aggregates</a></li>
</ul>
<h2 id="main-summary">Main Summary</h2>
<p>The <code>main_summary</code> table is the most direct representation of a main ping but
can be difficult to work with due to its size. </p>
<h3 id="rows-and-columns">Rows and Columns</h3>
<p>The <code>main_summary</code> table contains one row for each ping.  Each column
represents one field from the main ping payload, though only a subset of all
main ping fields are included.</p>
<h3 id="background-and-caveats">Background and Caveats</h3>
<p>This table is massive, and due to it&apos;s size, it can be difficult to work with.
You should <strong>avoid querying <code>main_summary</code></strong> from
<a href="sql.telemetry.mozilla.com">re:dash</a>.  Your queries will be <strong>slow to
complete</strong> and can <strong>impact performance for other users</strong>, since re:dash on a
shared cluster.</p>
<p>Instead, we recommend using the <code>longitudinal</code> or <code>cross_sectional</code> dataset
where possible.  If these datasets do not suffice, consider using Spark on an
<a href="analysis.telemetry.mozilla.com">ATMO</a> cluster.  In the odd case where these
queries are necessary, make use of the <code>sample_id</code> field and limit to a short
submission date range.</p>
<h2 id="longitudinal">Longitudinal</h2>
<p>The <code>longitudinal</code> dataset is a 1% sample of main ping data organized to
roughly represent a user. If you&apos;re not sure which dataset to use for your
analysis, this is probably what you want.</p>
<h3 id="rows-and-columns">Rows and Columns</h3>
<p>Each row in the <code>longitudinal</code> dataset represents one <code>client_id</code>, which is a
rough approximation of a user.  Each column represents a field from the main
ping.  Most fields contain arrays of values, with one value for each ping
associated with a client_id. Using arrays give you access to the raw data from
each ping, but can be difficult to work with from SQL.  Take a look at the
<a href="longitudinal_examples.md">longitudinal examples</a> if you get stuck.</p>
<h3 id="background-and-caveats">Background and Caveats</h3>
<p>Think of the longitudinal table as wide and short.  The dataset contains more
columns than <code>main_summary</code> and down-samples to 1% of all clients to reduce
query computation time and save resources.</p>
<p>In summary, the longitudinal table differs from <code>main_summary</code> in two important
ways:</p>
<ul>
<li>The longitudinal dataset groups all data so that one row represents a client_id</li>
<li>The longitudinal dataset samples to 1% of all client_ids</li>
</ul>
<h2 id="cross-sectional">Cross Sectional</h2>
<p>The <code>cross_sectional</code> dataset provides descriptive statistics for each
client_id in a 1% sample of main ping data. This dataset simplifies the
longitudinal table by replacing the longitudinal arrays with summary
statistics. This is the most useful dataset for describing our user base.</p>
<h3 id="rows-and-columns">Rows and Columns</h3>
<p>Each row in the <code>cross_sectional</code> dataset represents one <code>client_id</code>, which is
a rough approximation to a user.  Each column is a summary statistic describing
the client_id.</p>
<p>For example, the longitudinal table has a row called <code>geo_country</code> which
contains an array of country codes. For the same client_id the
<code>cross_sectional</code> table has columns called <code>geo_country_mode</code> and
<code>geo_country_configs</code> containing single summary statistics for the modal country and the
number of distinct countries in the array.</p>
<table>
<thead>
<tr>
<th><code>client_id</code></th>
<th style="text-align:center"><code>geo_country</code></th>
<th style="text-align:center"><code>geo_country_mode</code></th>
<th style="text-align:center"><code>geo_country_configs</code></th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td style="text-align:center">array&lt;&quot;US&quot;&gt;</td>
<td style="text-align:center">&quot;US&quot;</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td>2</td>
<td style="text-align:center">array&lt;&quot;DE&quot;, &quot;DE&quot; &quot;US&quot;&gt;</td>
<td style="text-align:center">&quot;DE&quot;</td>
<td style="text-align:center">2</td>
</tr>
</tbody>
</table>
<h3 id="background-and-caveats">Background and Caveats</h3>
<p>This table is much easier to work with than the longitudinal dataset because
you don&apos;t need to work with arrays.  Note that this dataset is a summary of the
longitudinal dataset, so it is also a 1% sample of all client_ids. </p>
<h2 id="client-count">Client Count</h2>
<p>The <code>client_count</code> dataset is simply a count of clients in a time period,
stratified over a set of dimensions.</p>
<h3 id="rows-and-columns">Rows and Columns</h3>
<p>This dataset includes columns for a dozen factors and an HLL variable.  The
<code>hll</code> column contains a
<a href="https://en.wikipedia.org/wiki/HyperLogLog" target="_blank">HyperLogLog</a> variable, which is an
approximation to the exact count.  The factor columns include activity date and
the dimensions listed
<a href="https://github.com/mozilla/telemetry-batch-view/blob/master/src/main/scala/com/mozilla/telemetry/views/ClientCountView.scala#L22" target="_blank">here</a>.
Each row represents one combinations of the factor columns.</p>
<h3 id="background-and-caveats">Background and Caveats</h3>
<p>It&apos;s important to understand that the <code>hll</code> column is <strong>not a standard count</strong>.
The <code>hll</code> variable avoids double-counting users when aggregating over
multiple days.  The HyperLogLog variable is a far more efficient way to count
distinct elements of a set, but comes with some complexity.  To find the
cardinality of an HLL use <code>cardinality(cast(hll AS HLL))</code>.  To find the union
of two HLL&apos;s over different dates, use <code>merge(cast(hll AS HLL))</code>.  The <a href="https://sql.telemetry.mozilla.org/queries/81/source#129" target="_blank">Firefox
ER Reporting Query</a> is
a good example to review.  Finally, Roberto has a relevant writeup
<a href="https://robertovitillo.com/2016/04/12/measuring-product-engagment-at-scale/" target="_blank">here</a>.</p>
<h2 id="crash-aggregates">Crash Aggregates</h2>
<p>The Crash Aggregates dataset compiles crash statistics over various dimensions for each day.</p>
<h3 id="rows-and-columns">Rows and Columns</h3>
<p>There&apos;s one column for each of the stratifying dimensions and the crash
statistics.  Each row is a distinct set of dimensions, along with their
associated crash stats.  Example stratifying dimensions include channel and
country, example statistics include usage hours and plugin crashes. See the
<a href="CrashAggregateView.md">complete documentation</a> for all available dimensions
and statistics.</p>
<h1 id="appendix">Appendix</h1>
<h2 id="mobile-metrics">Mobile Metrics</h2>
<p>There are several tables owned by the mobile team documented
<a href="https://wiki.mozilla.org/Mobile/Metrics/Redash" target="_blank">here</a>: </p>
<ul>
<li>android_events</li>
<li>android_clients</li>
<li>android_addons</li>
<li>mobile_clients</li>
</ul>
<h2 id="wiki-for-reference-a-previous-version-of-this-document-was-stored">Wiki For reference, a previous version of this document was stored</h2>
<p><a href="https://wiki.mozilla.org/Telemetry/Available_Telemetry_Datasets_and_their_Applications" target="_blank">here</a>.</p>
<h2 id="who-to-contact">Who to Contact</h2>
<p>Feel free to open an issue or contact Ryan Harter
(<a href="https://github.com/harterrt" target="_blank">@harterrt</a>) to identify errors or confusing
parts of this documentation.  I will be reviewing this documentation quarterly
for accuracy.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="analysis_intro.html" class="navigation navigation-prev " aria-label="Previous page: Analysis Quick Start">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../datasets/" class="navigation navigation-next " aria-label="Next page: Data Collection and Datasets">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Choosing a Dataset","level":"1.2.2","depth":2,"next":{"title":"Data Collection and Datasets","level":"1.3","depth":1,"path":"datasets/README.adoc","ref":"datasets/README.adoc","articles":[{"title":"Understanding our Data","level":"1.3.1","depth":2,"ref":"","articles":[{"title":"How we collect data (pings, studies, experiments)","level":"1.3.1.1","depth":3,"ref":"","articles":[]},{"title":"Choosing a dataset","level":"1.3.1.2","depth":3,"ref":"","articles":[]},{"title":"Experimental vs Descriptive Data","level":"1.3.1.3","depth":3,"ref":"","articles":[]}]},{"title":"Dataset Reference","level":"1.3.2","depth":2,"ref":"","articles":[{"title":"Pings","level":"1.3.2.1","depth":3,"ref":"","articles":[]},{"title":"Derived Datasets","level":"1.3.2.2","depth":3,"ref":"","articles":[{"title":"Longitudinal","level":"1.3.2.2.1","depth":4,"ref":"","articles":[]},{"title":"Cross Sectional","level":"1.3.2.2.2","depth":4,"ref":"","articles":[]},{"title":"Main Summary","level":"1.3.2.2.3","depth":4,"ref":"","articles":[]},{"title":"Crash Summary","level":"1.3.2.2.4","depth":4,"ref":"","articles":[]},{"title":"ETC","level":"1.3.2.2.5","depth":4,"ref":"","articles":[]}]},{"title":"Experimental Datasets","level":"1.3.2.3","depth":3,"ref":"","articles":[{"title":"Accessing Shield Study data","level":"1.3.2.3.1","depth":4,"ref":"","articles":[]}]}]}]},"previous":{"title":"Analysis Quick Start","level":"1.2.1","depth":2,"path":"concepts/analysis_intro.adoc","ref":"concepts/analysis_intro.adoc","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["livereload"],"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"concepts/choosing_a_dataset.md","mtime":"2017-01-26T22:31:59.000Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-01-31T16:49:22.947Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

